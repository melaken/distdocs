<!DOCTYPE html>
<html lang="fr" xmlns="http://www.w3.org/1999/xhtml"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:ui="http://java.sun.com/jsf/facelets"
	xmlns:p="http://primefaces.org/ui">
<h:head>
<title>Statistiques</title>
	<meta charset="utf-8" />
	<meta name="viewport" content="width=device-width, initial-scale=1" />
	<h:outputStylesheet library="default" name="css/form.css" />
	<h:outputStylesheet library="default" name="css/style.css" />
	<h:outputStylesheet name="primeicons/primeicons.css"
		library="primefaces" />
	<h:outputStylesheet name="components.css" library="primefaces" />
	<h:outputStylesheet name="charts/charts.css" library="primefaces" />

	<h:outputScript name="charts/charts.js" library="primefaces" />
</h:head>
<h:body>
	<ui:insert name = "nav" >
      <ui:include src = "#{constanteBean.menuBarWithoutSearch}" />
   </ui:insert>
<p:tabMenu activeIndex="2" >
		<p:menuitem value="Stats des ventes" icon="pi pi-money-bill" outcome="#{constanteBean.statsVentes1}"
				rendered="#{sessionScope['user'].userType != 'CLIENT'}">
				<f:param name="i" value="0" />
			</p:menuitem>
			<p:menuitem value="Stats par client" icon="pi pi-money-bill" outcome="#{constanteBean.statsVentes}"
				rendered="#{sessionScope['user'].userType != 'CLIENT'}">
				<f:param name="i" value="1" />
			</p:menuitem>
			<p:menuitem value="Stats des transactions" icon="pi pi-check-circle" outcome="#{constanteBean.statsTransactions}"
				rendered="#{sessionScope['user'].userType == 'ADMIN'}">
				<f:param name="i" value="2" />
			</p:menuitem>
			<p:menuitem value="Stats des documents" icon="pi pi-check-circle" outcome="#{constanteBean.statsDocs}"
				rendered="#{sessionScope['user'].userType == 'ADMIN' or sessionScope['user'].userType == 'EDITEUR'}">
				<f:param name="i" value="3" />
			</p:menuitem>
		</p:tabMenu>
	<h:form >
		<p:panel header="Critères des statistiques"
			style="margin-bottom:10px;">
			<h:panelGrid columns="4" cellpadding="5" style="margin-bottom:10px">
				<h:panelGrid columns="2">
					<h:outputText for="debutStatsTrans" value="Début période ciblée"
						style="font-weight:bold" />
					<p:calendar id="debutStatsTrans"
						value="#{statsTransactionBean.debutStatsTrans}" showOn="button"
						effect="fold" placeholder="Exemple 18/11/19" />
				</h:panelGrid>
				<h:panelGrid columns="2">
					<h:outputText for="finStatsTrans" value="Fin période ciblée"
						style="font-weight:bold" />
					<p:calendar id="finStatsTrans"
						value="#{statsTransactionBean.finStatsTrans}" showOn="button"
						effect="fold" placeholder="Exemple 18/11/19" />
				</h:panelGrid>
				<h:panelGrid columns="2">
					<h:outputText for="nbClients" value="Nombre de clients"
						style="font-weight:bold" />
					<p:selectOneMenu id="nbClients"
						value="#{statsTransactionBean.nbCl}" style="width:40px">
						<f:selectItem itemLabel="" itemValue="" noSelectionOption="true" />
						<f:selectItems value="#{staticticsBean.nbClients}" />
					</p:selectOneMenu>
				</h:panelGrid>
				<h:panelGrid columns="1">
					<p:commandButton value="Générer stats"
						action="#{statsTransactionBean.createStatsTrans}"
						icon="pi pi-chart-bar" />
				</h:panelGrid>
			</h:panelGrid>

		</p:panel>
	</h:form>
	<p:chart id="statsTrans" type="pie"
		model="#{statsTransactionBean.statsTrans}" 
		responsive="true" style="height:300px" />
	<br />
	<br />
	<p:chart type="bar" model="#{statsTransactionBean.transPerClient}"
		responsive="true"
		style="text-size:14px;height:300px" />
</h:body>
</html>