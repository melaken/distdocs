<!DOCTYPE html>
<html lang="fr"
xmlns="http://www.w3.org/1999/xhtml"
xmlns:f="http://java.sun.com/jsf/core"
xmlns:h="http://java.sun.com/jsf/html"
xmlns:ui="http://java.sun.com/jsf/facelets"
xmlns:p="http://primefaces.org/ui">
	<h:head>
		<title>Statististiques</title>
		<meta charset="utf-8"/>
  		<meta name="viewport" content="width=device-width, initial-scale=1"/>
  		<h:outputStylesheet library="default" name="css/form.css" />
  		<h:outputStylesheet library="default" name="css/style.css" />
  		<h:outputStylesheet name="primeicons/primeicons.css" library="primefaces"/>
  		<h:outputStylesheet name="components.css" library="primefaces"/>
	</h:head>
	<h:body>
	<h:form>  
    <p:growl id="messages"/>
 	
 	<p:toolbar id="tb" style="height:80px;font-size:13px;background-color:#0060a0;margin-right:0px;margin-left:0px;">
        <f:facet name="left">
        </f:facet>
        <f:facet name="right" style="margin-right:20px;">
		<p:linkButton outcome="#{constanteBean.accueil}" value="Accueil" icon="pi pi-home" rendered="#{sessionScope['user'] != null}" 
			style="margin-top:50px"/>
				 
        <p:menuButton value="#{sessionScope['user'].nom}" style="font-size:13px;margin-right:20px;margin-top:20px;padding:5px"
        	icon="pi pi-user" rendered="#{sessionScope['user'] != null}">
        		
        		<p:menuitem value="Publier" outcome="#{constanteBean.upload}" icon="pi pi-upload"
     				style="padding-left:10px" rendered="#{sessionScope['user'].userType == 'EDITEUR'}"/> 
    			<p:menuitem value="Ma bibliothèque" outcome="#{constanteBean.biblio}" 
    			icon="pi pi-file" style="padding-left:10px"/> 
     			<p:menuitem value="Mes transactions"  outcome="#{constanteBean.listUserTransactions}" 
     				icon="pi pi-money-bill" style="padding-left:10px"/>
     			<p:menuitem value="Paramètres"  icon="pi pi-cog" style="padding-left:10px"/>
     			<p:menuitem value="Statistiques"  outcome="#{constanteBean.stats}" icon="pi pi-chart-bar" style="padding-left:10px"/>
     			<p:separator /> 
     			<p:menuitem value="Déconnexion" action="#{connexionBean.logout}" type="button" icon="pi pi-sign-out" style="padding-left:10px;"
     			rendered="#{sessionScope['user'] != null}" update="@form"/> 
        </p:menuButton>
        </f:facet>
    </p:toolbar>
    <p:sticky target="tb" />
    
    </h:form>  
      <h:form>
	   <p:tabMenu activeIndex="#{param.i}">
		    <p:menuitem value="Stats des transactions" icon="pi pi-check-circle" outcome="#{constanteBean.stats}" >
		        <f:param name="i" value="0" />
		    </p:menuitem>
		    <p:menuitem value="Stats des ventes" icon="pi pi-money-bill" outcome="#{constanteBean.stats}" >
		        <f:param name="i" value="1" />
		    </p:menuitem>
		</p:tabMenu>
	</h:form>
	<h:form rendered="#{param.i == 0}">
		<h:panelGrid columns="3" cellpadding="5" style="margin-bottom:10px">
		 	<f:facet name="header">Critères</f:facet>
		 	<h:panelGrid columns="2" >
	 		 	<h:outputLabel for="debutStatsTrans" value="Début période ciblée" style="font-weight:bold" />
	 		 	 <p:calendar id="debutStatsTrans" value="" showOn="button"  
	 		 	 	effect="fold" placeholder="Exemple 18/11/19" />
 		 	</h:panelGrid>
 		 	<h:panelGrid columns="2" >
	 		 	<h:outputLabel for="finStatsTrans" value="Fin période ciblée" style="font-weight:bold" />
	 		 	 <p:calendar id="finStatsTrans" value="" showOn="button"  
	 		 	 	effect="fold" placeholder="Exemple 18/11/19" />
 		 	</h:panelGrid>
 		 	<h:panelGrid columns="1" >
   	    		<p:commandButton value="Générer stats"  action="#{staticticsBean.createStatsTrans}" 
   	    		icon="pi pi-chart-bar" align="center" update=":statsTrans" />
   	    	</h:panelGrid>
		 </h:panelGrid>
    </h:form>
		<p:chart id="statsTrans" type="pie" model="#{staticticsBean.statsTrans}" rendered="#{param.i == 0}"
			style="height:300px"/>
	<br /><br />
	
		<h:form rendered="#{param.i == 0}">
		<h:panelGrid columns="4" cellpadding="1" style="margin-bottom:10px">
		 	<f:facet name="header">Critères</f:facet>
		 	<h:panelGrid columns="3" >
	 		 	<h:outputLabel for="debutdaByUser" value="Début période ciblée" style="font-weight:bold" />
	 		 	 <p:calendar id="debutdaByUser" value="" showOn="button"  
	 		 	 	effect="fold" placeholder="Exemple 18/11/19" />
 		 	</h:panelGrid>
 		 	<h:panelGrid columns="2" >
	 		 	<h:outputLabel for="findaByUser" value="Fin période ciblée" style="font-weight:bold" />
	 		 	 <p:calendar id="findaByUser" value="" showOn="button"  
	 		 	 	effect="fold" placeholder="Exemple 18/11/19" />
 		 	</h:panelGrid>
 		 	<h:panelGrid columns="2" >
	 		 	<h:outputLabel for="nbClients" value="Nombre de clients" style="font-weight:bold" />
	 		 	 <p:inputNumber id="nbClients" value="" minValue="0" emptyValue="empty" decimalPlaces="0"/>
 		 	</h:panelGrid>
 		 	<h:panelGrid columns="1" >
   	    		<p:commandButton value="Générer stats"  icon="pi pi-chart-bar" align="center" ajax="false" />
	    	</h:panelGrid>
		 </h:panelGrid>
    </h:form>
		<p:chart type="pie" model="#{staticticsBean.daByUser}" rendered="#{param.i == 0}"
			style="width:400px;height:300px" />
		<br /><br />
		<p:chart type="bar" model="#{staticticsBean.docSoldByPublisher}" rendered="#{param.i == 1}"
			style="height:300px"/>
	<br /><br />
		<p:chart type="bar" model="#{staticticsBean.transPerClient}" rendered="#{param.i == 1}" 
			style="height:300px"/>
	<br /><br />
	</h:body>
</html>