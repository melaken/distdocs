<!DOCTYPE html>
<html lang="fr" xmlns="http://www.w3.org/1999/xhtml"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:ui="http://java.sun.com/jsf/facelets"
	xmlns:p="http://primefaces.org/ui">
<h:head>
<title>Statistiques</title>
	<meta charset="utf-8" />
	<meta name="viewport" content="width=device-width, initial-scale=1" />
	<h:outputStylesheet library="default" name="css/form.css" />
	<h:outputStylesheet library="default" name="css/style.css" />
	<h:outputStylesheet name="primeicons/primeicons.css"
		library="primefaces" />
	<h:outputStylesheet name="components.css" library="primefaces" />
	<h:outputStylesheet name="charts/charts.css" library="primefaces" />

	<h:outputScript name="charts/charts.js" library="primefaces" />
</h:head>
<h:body>
	<ui:insert name = "nav" >
      <ui:include src = "#{constanteBean.menuBarWithoutSearch}" />
   </ui:insert>
	<p:tabMenu activeIndex="1" >
		<p:menuitem value="Stats des ventes" icon="pi pi-money-bill" outcome="#{constanteBean.statsVentes1}"
				rendered="#{sessionScope['user'].userType != 'CLIENT'}">
				<f:param name="i" value="0" />
			</p:menuitem>
			<p:menuitem value="Stats par client" icon="pi pi-money-bill" outcome="#{constanteBean.statsVentes}"
				rendered="#{sessionScope['user'].userType != 'CLIENT'}">
				<f:param name="i" value="1" />
			</p:menuitem>
			<p:menuitem value="Stats des transactions" icon="pi pi-check-circle" outcome="#{constanteBean.statsTransactions}"
				rendered="#{sessionScope['user'].userType == 'ADMIN'}">
				<f:param name="i" value="2" />
			</p:menuitem>
		</p:tabMenu>
	<h:form >
		<p:growl>
			<p:autoUpdate />
		</p:growl>
		<p:panel header="Critères des statistiques"
			style="margin-bottom:10px;">
			<h:panelGrid columns="5" cellpadding="5">
				<h:panelGrid columns="2">
					<h:outputText for="debutdaByUser" value="Début période ciblée"
						style="font-weight:bold;" />
					<p:calendar id="debutdaByUser" value="#{statsVentesBean.dateDebut}"
						style="width:60px" showOn="button" effect="fold"
						placeholder="Exemple 18/11/19" />
				</h:panelGrid>
				<h:panelGrid columns="2">
					<h:outputText for="findaByUser" value="Fin période ciblée"
						style="font-weight:bold;" />
					<p:calendar id="findaByUser" value="#{statsVentesBean.dateFin}"
						style="margin-left:1px" showOn="button" effect="fold"
						placeholder="Exemple 18/11/19" />
				</h:panelGrid>
				<h:panelGrid columns="2">
					<h:outputText for="nbClients" value="Nombre de clients"
						style="font-weight:bold" />
					<p:selectOneMenu id="nbClients" value="#{statsVentesBean.nbCl}"
						style="width:40px">
						<f:selectItem itemLabel="" itemValue="" noSelectionOption="true" />
						<f:selectItems value="#{staticticsBean.nbClients}" />
					</p:selectOneMenu>
				</h:panelGrid>
				<h:panelGrid columns="2" rendered="#{sessionScope['user'] != null and sessionScope['user'].userType == 'ADMIN'}">
					<h:outputText for="editeur" value="Éditeur"
						style="font-weight:bold" />
					<p:selectOneMenu id="editeur" value="#{statsVentesBean.editeur}"
						style="width:100px">
						<f:selectItem itemLabel="" itemValue="" noSelectionOption="true" />
						<f:selectItems value="#{staticticsBean.editeurs}" var="edit"
							itemValue="#{edit.id}" itemLabel="#{edit.maisonEdition}" />
					</p:selectOneMenu>
				</h:panelGrid>
				<h:panelGrid columns="2">
					<h:outputText for="docType" value="Type de contenu"
						style="font-weight:bold" />
					<p:selectOneMenu id="docType" value="#{statsVentesBean.docType}"
						style="width:180px">
						<f:selectItem itemLabel="" itemValue="" noSelectionOption="true"/>
						<f:selectItem itemLabel="MAGAZINE" itemValue="MAGAZINE" />
						<f:selectItem itemLabel="JOURNAL" itemValue="JOURNAL" />
						<f:selectItem itemLabel="LIVRE" itemValue="LIVRE" />
					</p:selectOneMenu>
				</h:panelGrid>
				<h:panelGrid columns="1">
					<p:commandButton value="Générer stats"
						action="#{statsVentesBean.generateStats}" icon="pi pi-chart-bar"
						align="center" ajax="false" />
				</h:panelGrid>
			</h:panelGrid>

		</p:panel>
	</h:form>
	<p:chart type="pie" model="#{statsVentesBean.daByUser}"
		responsive="true" style="height:300px" />
	<br />
	<br />
	<p:chart type="bar" model="#{statsVentesBean.daByUserByDoctype}"
		responsive="true" style="height:300px" />
</h:body>
</html>