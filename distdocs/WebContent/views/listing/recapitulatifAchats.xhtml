<!DOCTYPE html>
<html lang="fr" xmlns="http://www.w3.org/1999/xhtml"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:ui="http://java.sun.com/jsf/facelets"
	xmlns:p="http://primefaces.org/ui">
<h:head>
	<title>Récapitulatif des achats</title>
	<h:outputStylesheet name="primeicons/primeicons.css"
		library="primefaces" />
		<h:outputStylesheet library="default" name="css/form.css" />
	<h:outputStylesheet library="default" name="css/style.css" />
	<style>
body {
	text-align: center;
}

.emoticone {
	width: 35px !important;
	font-size: 35px !important;
	color: #0060a0;
	padding-left: 10px;
}
</style>
</h:head>
<h:body>
	<ui:insert name="nav">
		<ui:include src="#{constanteBean.menuBarWithoutSearch}" />
	</ui:insert>
	<p style="text-align: center">
	<h2>Récapitulatif des achats</h2>
	</p>

	<p:dataTable var="doc" value="#{panierBean.articles}" id="listeDocs"
		style="margin-top:10px" emptyMessage="Aucun article dans votre panier">
		<p:column headerText="Article">
			<h:form id="formListe">
<!-- 				<p:commandLink update="formListe:image" -->
<!-- 					onclick="PF('coverDialog').show()"> -->
					<p:graphicImage value="#{listeDocsBean.image}" onclick="PF('coverDialog').show()"
						style="height: 100px; width: 70px;border-radius: 2px">
						<f:param name="cover" value="#{doc.premiereCouverture}" />
					</p:graphicImage>
<!-- 					<f:setPropertyActionListener value="#{doc}" -->
<!-- 						target="#{listeDocsBean.selectedDoc}" /> -->
<!-- 				</p:commandLink> -->
				<p:dialog id="dialog" widgetVar="coverDialog" modal="true"
					showEffect="fade" hideEffect="fade" resizable="false"
					header="Aperçu">
					<p:outputPanel id="image" style="text-align:justify;border:0">
						<p:panelGrid columns="1"
							rendered="#{not empty listeDocsBean.selectedDoc}"
							columnClasses="label,value">
							<p:graphicImage value="#{listeDocsBean.image}"
								style="height:600px; width:400px">
								<f:param name="cover"
									value="#{doc.premiereCouverture}" />
							</p:graphicImage>
						</p:panelGrid>
					</p:outputPanel>
				</p:dialog>
			</h:form>
		</p:column>
		<p:column headerText="Prix">
			<h:outputText value="#{doc.prix}	FCFA" />
		</p:column>
		<p:column headerText=" ">
			<h:form>
				<p:commandLink title="Retirer cet article du panier"
					action="#{panierBean.supprimerDoc}" update=":listeDocs :total">
					<f:param name="docId" value="#{doc.id}" />
					<h:outputText styleClass="pi pi-trash emoticone"
						style="margin:0 auto;text-align:center;" />
					<!--                 <f:setPropertyActionListener value="#{doc}" target="#{listeDocsBean.selectedDoc}" /> -->
				</p:commandLink>
			</h:form>
		</p:column>
	</p:dataTable>

	<div align="center"
		style="font-weight: bold; margin-top: 10px; margin-bottom: 10px">
		<h:outputLabel value="Total : " />
		<h:outputText id="total" value="#{panierBean.total}	FCFA" />
	</div>
	<div align="right"
		style="font-weight: bold; margin-top: 10px; margin-bottom: 10px; padding-left: 5px">
		<p:commandButton action="#{panierBean.choisirPaiement}"
			value="Commander" icon="pi pi-chevron-right"
			rendered="#{panierBean.total > 0 and sessionScope['user'] != null }"
			style="margin-right:20px;">
			<f:setPropertyActionListener value="#{sessionScope['user'].id}"
				target="#{panierBean.clientId}" />
		</p:commandButton>
		<p:commandButton action="#{panierBean.continuerAchat}"
			value="Continuer les achats" icon="pi pi-shopping-cart"
			style="margin-right:20px;" />
		<p:commandButton action="#{panierBean.annulerAchat}" value="Annuler"
			icon="pi pi-undo" style="margin-right:20px;" />
	</div>
</h:body>
</html>